/**
 * Created by shenqilei on 2016/11/30.
 */
function refreshAccessTimeAnalysis(url){
	$.ajax({
        type:'POST',
        url:url,
        cache:false,
        success:function(data){
        	console.log(data);
        	/*
        	etcOnlineTimePerDay
        	etcOnlineTimePerRecord
        	pcOnlineTimePerDay
        	pcOnlineTimePerRecord
        	wirelessOnlineTimePerDay
        	wirelessOnlineTimePerRecord
        	*/
        	//每天
        	$("#teacherWireless_pc").html((data.teacher.pcOnlineTimePerDay).toFixed(2));
        	$("#studentWireless_mobile").html((data.student.wirelessOnlineTimePerDay).toFixed(2));
        	$("#teacherWireless_mobile").html((data.teacher.wirelessOnlineTimePerDay).toFixed(2));
        	$("#studentWireless_pc").html((data.student.pcOnlineTimePerDay).toFixed(2));
        	//每次
        	$("#every_time_teacherWireless_pc").html((data.teacher.pcOnlineTimePerRecord).toFixed(2));
        	$("#every_time_studentWireless_mobile").html((data.student.wirelessOnlineTimePerRecord).toFixed(2));
        	$("#every_time_teacherWireless_mobile").html((data.teacher.wirelessOnlineTimePerRecord).toFixed(2));
        	$("#every_time_studentWireless_pc").html((data.student.pcOnlineTimePerRecord).toFixed(2));
        	pieChart(data);
        	categoryChart(data);
        }
	});
}
function pieChart(data){
	var winWidth  = window.screen.width;
	var winHeight = window.screen.height;
	var width;
	var height;
	if(winWidth==1920 && winHeight==1080){
		width='300';
		height='180';
	}else if(winWidth==1600 && winHeight==900){
		width='300';
		height='180';
	}else if(winWidth==1366 && winHeight==768){
		width='340';
		height='130';
	}else if(winWidth==1280 && winHeight==1024){
		width='300';
		height='210';
	}
	var teacherPcPer=((data.teacher.pcOnlineTimePerDay/data.totalCountOnline)*100).toFixed(2);
	var studentPcPer=((data.student.pcOnlineTimePerDay/data.totalCountOnline)*100).toFixed(2);
	var teacherWirelessPer=((data.teacher.wirelessOnlineTimePerDay/data.totalCountOnline)*100).toFixed(2);
	var studentWirelessPer=((data.student.wirelessOnlineTimePerDay/data.totalCountOnline)*100).toFixed(2);
	 
	$("#a_everyday_data").ejChart({
        //Initializing Common Properties for all the series         
        commonSeriesOptions: 
		{
            labelPosition: 'outside',
            tooltip: { visible: true, format: "#point.x# : #point.y#%" },
	        marker:
			{
				dataLabel: 
				{ 
					shape: 'none', 
					visible: true, 
					textPosition: 'top', 
					border: { width: 1}, 
					font :{color : "rgb(255,255,255)",size:"1",fontWeight : "bold"},
					connectorLine: { height: 0, stroke:"black" } 
				}
            }
        },
		
		//Initializing Series
		series: 
		[
            {
                points: [
                         { x: "老师无线", text: teacherPcPer+"%", y: data.teacher.wirelessOnlineTimePerDay ,fill:'#40B811'},
						 { x: "学生有线", text: studentPcPer+"%", y: data.teacher.pcOnlineTimePerDay ,fill:'#11B898'}, 
						 { x: "老师有线", text: teacherWirelessPer+"%", y: data.student.pcOnlineTimePerDay ,fill:'#00FFFF'}, 
						 { x: "学生无线", text: studentWirelessPer+"%", y: data.student.wirelessOnlineTimePerDay , fill:'#008BD0'}
						], 
						 
				type: 'doughnut', 
				//explodeIndex: 4, 
				doughnutCoefficient: 0.5, 
				doughnutSize: 0.8
            }
        ], 
		
		//Enabling 3D Chart
        enable3D: true,	
		enableRotation: true,			
        depth: 30,
        tilt: -50,
        rotation: 0,
        perspectiveAngle: 90,                       
        canResize: true,
        load: "onchartload",                    
        size: { height: height},               
        legend: { visible: false}
    });
}

function categoryChart(data){
	var winWidth  = window.screen.width;
	var winHeight = window.screen.height;
	var width;
	var height;
	if(winWidth==1920 && winHeight==1080){
		width='300';
		height='50';
	}else if(winWidth==1600 && winHeight==900){
		width='300';
		height='50';
	}else if(winWidth==1366 && winHeight==768){
		width='340';
		height='50';
	}else if(winWidth==1280 && winHeight==1024){
		width='300';
		height='100';
	}
 	var teacher_pcOnlineTimePerRecord=Math.ceil(data.teacher.pcOnlineTimePerRecord);
 	var student_wirelessOnlineTimePerRecord=Math.ceil(data.student.wirelessOnlineTimePerRecord);
 	var teacher_wirelessOnlineTimePerRecord=Math.ceil(data.teacher.wirelessOnlineTimePerRecord);
 	var student_pcOnlineTimePerRecord=Math.ceil(data.student.pcOnlineTimePerRecord);
 	
	 $("#every_timr_analysis").ejChart(
		{
		//Initializing Primary X Axis	
        primaryXAxis:
        {                                
			//valueType: 'category',
            //labelFormat:"MMM",
            //title: { text: "Minerals" },
         	 visible : false,
         	 crossesAt: 90,
            majorGridLines: { visible: true, color: "#BACF25", opacity: 1 }
        },
		
		//Initializing Primary Y Axis	
        primaryYAxis:
        {         
         	crossesAt: 1,
			crossesInAxis: 'secondaryYAxis',
           	visible : false,
           //rangePadding : "none" ,
			majorGridLines: { visible: true, color: "#BACF25", opacity: 1}
        },
      	
        
		//Initializing Common Properties for all the series
		commonSeriesOptions:
		{
          	//columnFacet: "cylinder", 
          
			//tooltip: { visible: false, format: "#series.name#<br/>#point.x# : #point.y#mg" },  
		   columnWidth: 0.2,
           type: "column"     ,
           dataLabel: 
			{ 
				shape: 'none', 
				visible: false, 
				textPosition: 'top', 
              	font :{color : "rgb(17,93,163)",size:"20",fontWeight : "bold"},
				border: { width: 1},
			},
        },
        columnDefinitions :[{ columnWidth : 220 }] , 
		//Initializing Series
        series: 
			[                                                                                   
                {
                  points: [{ x: "老师有线", y: teacher_pcOnlineTimePerRecord,fill:'#40B811' }, 
                           { x: "学生无线", y: student_wirelessOnlineTimePerRecord,fill:'#11B898' }, 
                           { x: "老师无线", y: teacher_wirelessOnlineTimePerRecord,fill:'#00FFFF'}, 
                           { x: "学生有线", y: student_pcOnlineTimePerRecord,fill:'#008BD0'}
                           ], 
							 
					name: 'Minerals Content in Apple'
                }            
           ],
		
		//Enabling 3D Chart
        enable3D: true,	
		enableRotation: false,			
        depth: 100,
        wallSize: 2,
        //tilt:20,
        //rotation: -3,
        tilt:6,
        rotation: 0,
        perspectiveAngle: 90,
        sideBySideSeriesPlacement: true,
		//load: "loadTheme",
        //title: { text: 'Fruits Nutrients' },            
        isResponsive: false,
        canResize: true,
        //size: { height: '100'},
        size: { height: height},
        legend: { visible: false, size :{width : "100%"}  }
    });
}
